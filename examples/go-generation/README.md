# Go Code Generation Example

This example demonstrates how to generate idiomatic Go code from TypeMUX schemas.

## Features Demonstrated

- **Package Customization**: `@go.package("ecommerce")` annotation to set the package name
- **Enums**: `OrderStatus` enum with custom numbering
- **Structs**: `Product`, `Order`, and other types with various field types
- **Arrays**: `tags: []string`, `productIds: []string`
- **Maps**: `attributes: map<string, string>`
- **Timestamps**: `createdAt: timestamp` → `time.Time`
- **Unions**: `PaymentMethod` union type → Go interface pattern
- **Services**: `ProductService` and `OrderService` → Go interfaces
- **Documentation**: All comments are preserved in the generated code

## Usage

Generate Go code from the schema:

```bash
typemux -input schema.typemux -format go -output output
```

Or generate multiple formats at once:

```bash
typemux -input schema.typemux -format all -output output
```

## Package Customization

By default, the Go generator uses the last segment of the namespace as the package name. For example, `namespace example.go` becomes `package go`.

You can customize the package name using the `@go.package` annotation:

```typemux
@typemux("1.0.0")

@go.package("ecommerce")
namespace example.go

type Product {
    id: string
    name: string
}
```

This will generate:

```go
// Code generated by TypeMUX. DO NOT EDIT.
package ecommerce

type Product struct {
    Id string `json:"id"`
    Name string `json:"name"`
}
```

## Generated Code Structure

The generated `types.go` file includes:

### Enums
```go
type OrderStatus int

const (
    OrderStatusPENDING OrderStatus = 1
    OrderStatusPROCESSING OrderStatus = 2
    // ...
)
```

### Structs with JSON Tags
```go
type Product struct {
    Id string `json:"id"`
    Name string `json:"name"`
    Price int64 `json:"price"`
    Tags []string `json:"tags"`
    Attributes map[string]string `json:"attributes"`
}
```

### Union Types as Interfaces
```go
type PaymentMethod interface {
    isPaymentMethod()
}

type PaymentMethodCreditCard struct {
    Value CreditCard `json:"value"`
}

func (PaymentMethodCreditCard) isPaymentMethod() {}
```

### Service Interfaces
```go
type ProductService interface {
    GetProduct(input *GetProductRequest) (*GetProductResponse, error)
    CreateProduct(input *Product) (*Product, error)
    // ...
}
```

## Using the Generated Code

```go
package main

import (
    "fmt"
    "time"
    "your-module/output"
)

func main() {
    // Create a product
    product := output.Product{
        Id:          "prod-123",
        Name:        "Laptop",
        Description: "High-performance laptop",
        Price:       99999, // in cents
        InStock:     true,
        Tags:        []string{"electronics", "computers"},
        Attributes: map[string]string{
            "brand": "TechCorp",
            "model": "X1000",
        },
        Discount: 10.0,
    }

    // Create an order
    order := output.Order{
        Id:              "order-456",
        CustomerId:      "cust-789",
        ProductIds:      []string{"prod-123"},
        Status:          output.OrderStatusPENDING,
        TotalAmount:     89999, // after discount
        CreatedAt:       time.Now(),
        ShippingAddress: "123 Main St",
    }

    fmt.Printf("Created order %s for %d products\n",
        order.Id, len(order.ProductIds))
}
```

## Type Mapping

TypeMUX types are mapped to Go types as follows:

| TypeMUX Type | Go Type              |
|--------------|----------------------|
| `string`     | `string`             |
| `int32`      | `int32`              |
| `int64`      | `int64`              |
| `float32`    | `float32`            |
| `float64`    | `float64`            |
| `bool`       | `bool`               |
| `timestamp`  | `time.Time`          |
| `bytes`      | `[]byte`             |
| `[]T`        | `[]T`                |
| `map<K,V>`   | `map[K]V`            |

## Field Name Conversion

Field names are automatically converted from snake_case to PascalCase for export:

- `user_id` → `UserId`
- `created_at` → `CreatedAt`
- `is_active` → `IsActive`
